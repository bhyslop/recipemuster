{
  "steps": [
    {
      "name": "gcr.io/cloud-builders/gcloud",
      "id": "auth-docker-to-gar",
      "entrypoint": "bash",
      "args": [
        "-lc",
        "set -euo pipefail\ngcloud auth configure-docker \"${_RBGY_GAR_LOCATION}-docker.pkg.dev\" --quiet\n"
      ]
    },
    {
      "name": "gcr.io/go-containerregistry/gcrane",
      "id": "copy",
      "entrypoint": "/bin/sh",
      "args": [
        "-c",
        "set -eu\nSRC=\"${_SRC_IMAGE}\"   # e.g. docker.io/library/busybox:1.37\nDEST=\"${_RBGY_GAR_LOCATION}-docker.pkg.dev/${_RBGY_GAR_PROJECT}/${_RBGY_GAR_REPOSITORY}/${_DEST_PATH}:${_DEST_TAG}\"\n# For private sources you can: gcrane auth login docker.io -u \"$DOCKER_USER\" -p \"$DOCKER_PASS\"\ngcrane cp \"${SRC}\" \"${DEST}\"\necho \"${DEST}\" > copied.txt\n"
      ]
    },
    {
      "name": "gcr.io/cloud-builders/gcloud",
      "id": "note",
      "entrypoint": "bash",
      "args": [
        "-lc",
        "set -euo pipefail\necho \"Copied to: $(cat copied.txt)\"\n"
      ]
    }
  ],
  "options": {
    "machineType": "${_RBGY_MACHINE_TYPE}",
    "logging": "CLOUD_LOGGING_ONLY"
  },
  "timeout": "${_RBGY_TIMEOUT}",
  "substitutions": {
    "_RBGY_GAR_LOCATION": "us-central1",
    "_RBGY_GAR_PROJECT": "your-project-id",
    "_RBGY_GAR_REPOSITORY": "your-repo",
    "_DEST_PATH": "imported/busybox",
    "_DEST_TAG": 1.37,
    "_SRC_IMAGE": "docker.io/library/busybox:1.37",
    "_RBGY_MACHINE_TYPE": "E2_HIGHCPU_8",
    "_RBGY_TIMEOUT": "600s"
  }
}
